## Genome k-mer similarity networks of bacteria and their prophages linked to anti-viral defence genes describe co-evolution
 As antimicrobial resistance increases globally, bacteriophages have become a promising alternative for traditional antibiotic approaches. However, development of phage therapies (PT) can be slow and expensive due to their specific nature. Phage host-range assays remain the gold standard.
 As phages are evolving entities, co-evolution of phage and host is key to finding effective candidates against strains of interest. A review (Lood et al, 2022) proposed that a multilayer machine-learning approach to phage-susceptibility testing would involve understanding the co-evolution of defence systems. Here, we highlight the complexity of this task for prophage and host co-evolution in silico. 
We identified 3,221 prophages within 2,119 Streptococcus suis genomic assemblies, and created a bipartite k-mer similarity network between prophages and hosts where prophage-to-bacteria connections represent the host a prophage was identified from. Condensing our network into community-representative nodes allows us to make assumptions about infection potential of individual prophages based on community membership. Over 57,000 phage-defence proteins were annotated amongst our genomes. Associations/disassociations were calculated between infection- and defence-profiles of the host. Linking these events to the phylogeny of S. suis allows us to infer co-evolution events.
 These findings emphasise the complexity of phage-host interactions and simply linking defence genes to categories of susceptible/resistant is not sufficient. The presence of a defence system may facilitate mechanisms other than host-evasion. The co-evolution of prophages with their hosts not only affect the fitness of the host, but may be an indicator to how it will interact with other phages, which will be crucial for developing PT.

# How it works
This script takes a Sourmash (https://github.com/sourmash-bio/sourmash) csv output matrix and converts it to an edgetable for use in cytoscape. 
It then uses iGraph Louvain method to iteratively check for communities with this edgetable, removing edges below a cutoff, then checking again. 
The number of communities at each iteration is counted, and the 'elbow' or 'knee' of the curve calculated using kneebow. 

This 'knee' is then taken as the optimal edgeweight cut off for the network. With the idea that cutoffs below are too interconnected and cutoffs above are too fragmented.
